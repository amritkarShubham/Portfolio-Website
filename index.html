<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shubham Amritkar | Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Theme Colors - Feel free to change these! */
            --bg-color: #2D232E;
            --text-color: #E0E0CE;
            --primary: #FFADAD;
            --secondary: #A0C4FF;
            --accent: #FDFFB6;
            --box-bg: #4A3B4E;
            --scanline-opacity: 0.15;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            overflow-x: hidden;
            position: relative;
        }

        h1, h2, h3, .pixel-btn, button, .nav-links a, .logo {
            font-family: 'Press Start 2P', cursive;
            text-transform: uppercase;
        }

        /* --- CRT Effect --- */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px; pointer-events: none; z-index: 999;
            opacity: var(--scanline-opacity); animation: flicker 0.15s infinite;
        }

        /* --- Nav --- */
        nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 2rem; max-width: 1200px; margin: 0 auto;
        }
        .logo { font-size: 1.2rem; color: var(--primary); text-shadow: 2px 2px 0px #000; }
        .nav-links a {
            color: var(--text-color); text-decoration: none; margin-left: 2rem;
            font-size: 0.7rem; position: relative; transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--accent); }
        .nav-links a:hover::before {
            content: '►'; position: absolute; left: -15px;
            color: var(--accent); animation: blink 1s infinite;
        }

        /* --- Hero --- */
        .hero {
            min-height: 85vh; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
            padding: 2rem 1rem;
            background: radial-gradient(circle at center, #4A3B4E 0%, var(--bg-color) 70%);
        }
        
        /* CUSTOMIZED CSS FOR YOUR AVATAR */
        .pixel-avatar {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-bottom: 2rem;
        }
        
        .pixel-avatar img {
            height: 195px; /* Passport size height */
            width: 150px; /* Passport size width */
            border: 4px solid var(--text-color); /* The retro border */
            box-shadow: 8px 8px 0px #000; /* The retro shadow block */
            object-fit: cover; /* Ensures image fills the space properly */
            /* Optional: Makes the photo look slightly pixelated to match the theme */
            /* image-rendering: pixelated; */ 
        }

        .hero h1 { font-size: 2.5rem; margin-bottom: 1.5rem; line-height: 1.4; text-shadow: 4px 4px 0px #000; }
        .hero p { font-size: 1.5rem; max-width: 600px; margin-bottom: 3rem; color: var(--secondary); }

        /* --- Buttons --- */
        .pixel-btn {
            background-color: var(--secondary); color: #000; border: 4px solid #fff;
            padding: 1rem 2rem; font-size: 0.8rem; cursor: pointer;
            box-shadow: 6px 6px 0px #000; text-decoration: none; display: inline-block;
            transition: transform 0.1s, box-shadow 0.1s;
            font-family: 'Press Start 2P';
        }
        .pixel-btn:hover { background-color: var(--accent); transform: translateY(-2px); box-shadow: 8px 8px 0px #000; }
        .pixel-btn:active { transform: translate(4px, 4px); box-shadow: 2px 2px 0px #000; }

        /* --- Projects (Static Version for easy use) --- */
        .projects { max-width: 1200px; margin: 4rem auto; padding: 0 2rem; }
        .section-title {
            font-size: 1.5rem; margin-bottom: 3rem; text-align: center;
            border-bottom: 4px solid var(--primary); display: inline-block; padding-bottom: 1rem;
            text-shadow: 2px 2px 0px #000;
            animation: glow 3s ease-in-out infinite;
        }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 3rem; }
        
        .card {
            background: linear-gradient(135deg, var(--box-bg) 0%, rgba(74, 59, 78, 0.8) 100%);
            border: 4px solid var(--text-color);
            padding: 1.5rem; position: relative; box-shadow: 8px 8px 0px #000;
            transition: transform 0.2s, box-shadow 0.2s; cursor: pointer;
        }
        .card:hover { transform: translateY(-8px); box-shadow: 12px 12px 0px rgba(255, 173, 173, 0.3); }
        .card-img {
            width: 100%; height: 150px; background-color: #000; margin-bottom: 1rem;
            border: 2px solid var(--text-color); display: flex;
            align-items: center; justify-content: center; color: #555;
            font-family: 'Press Start 2P'; font-size: 0.8rem;
        }
        .card h3 { font-size: 1rem; margin-bottom: 0.5rem; color: var(--accent); text-shadow: 1px 1px 0px #000; }
        .tags { margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .tag {
            font-size: 0.7rem; background: linear-gradient(135deg, rgba(0,0,0,0.6), rgba(0,0,0,0.8));
            color: var(--primary); padding: 0.3rem 0.7rem; border: 2px solid var(--primary);
            font-family: 'Press Start 2P'; transition: all 0.3s;
        }
        .tag:hover { background: var(--primary); color: #000; }

        /* --- Contact Section --- */
        .contact-section {
            max-width: 1200px; margin: 4rem auto; padding: 0 2rem; text-align: center;
        }
        .about-section {
            max-width: 1200px; margin: 4rem auto; padding: 2rem; text-align: center;
            background: rgba(74, 59, 78, 0.3);
            border: 2px solid var(--secondary);
            border-radius: 8px;
        }
        .social-links {
            display: flex; justify-content: center; gap: 1.5rem; flex-wrap: wrap; margin-top: 3rem;
        }
        .social-link {
            background: linear-gradient(135deg, var(--secondary), var(--secondary));
            color: #000; border: 4px solid #fff;
            padding: 0.8rem 1.5rem; font-size: 0.7rem; cursor: pointer;
            box-shadow: 6px 6px 0px #000; text-decoration: none; display: inline-block;
            transition: all 0.2s; font-family: 'Press Start 2P';
        }
        .social-link:hover { background-color: var(--accent); transform: translateY(-3px); box-shadow: 8px 8px 0px #000; }
        .social-link:active { transform: translate(4px, 4px); box-shadow: 2px 2px 0px #000; }

        /* --- Footer --- */
        footer { text-align: center; padding: 4rem 0; font-size: 1rem; opacity: 0.7; }

        /* --- GAME SECTION --- */
        .game-section {
            max-width: 1200px; margin: 4rem auto; padding: 0 2rem; text-align: center;
        }

        .game-container {
            background: linear-gradient(135deg, rgba(160, 196, 255, 0.1) 0%, rgba(255, 173, 173, 0.1) 100%);
            border: 4px solid var(--primary);
            padding: 1.5rem;
            box-shadow: 8px 8px 0px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(255, 173, 173, 0.1);
            max-width: 600px;
            margin: 2rem auto;
            position: relative;
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--secondary);
            gap: 1rem;
            flex-wrap: wrap;
        }

        .game-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
            min-width: 80px;
        }

        .stat-label {
            font-size: 0.65rem;
            color: var(--secondary);
            font-family: 'Press Start 2P';
        }

        .stat-value {
            font-size: 1.3rem;
            color: var(--accent);
            font-family: 'Press Start 2P';
            text-shadow: 0 0 10px var(--accent);
        }

        #game-canvas {
            display: block;
            margin: 0 auto 1rem;
            border: 4px solid var(--text-color);
            background-color: #000;
            box-shadow: 0 0 20px rgba(255, 173, 173, 0.3);
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            width: 100%;
            max-width: 400px;
            height: auto;
        }

        .game-controls {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border: 2px solid var(--secondary);
        }

        .control-text {
            font-size: 0.75rem;
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .touch-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .touch-controls.show {
            display: grid;
        }

        .arrow-btn {
            padding: 0.8rem;
            font-size: 1.2rem;
            background-color: var(--primary);
            border: 3px solid #fff;
            cursor: pointer;
            box-shadow: 4px 4px 0px #000;
            transition: all 0.1s;
            font-family: 'Press Start 2P';
            color: #000;
        }

        .arrow-btn:active { transform: translate(2px, 2px); box-shadow: 1px 1px 0px #000; }
        .arrow-btn.up { grid-column: 2; }
        .arrow-btn.left { grid-column: 1; }
        .arrow-btn.down { grid-column: 2; }
        .arrow-btn.right { grid-column: 3; }

        #start-game-btn {
            background-color: var(--primary);
            border-color: var(--accent);
            width: 100%;
            margin-top: 1rem;
        }

        #start-game-btn:hover {
            background-color: var(--accent);
            color: #000;
        }

        /* --- MUSIC PLAYER --- */
        .pixel-speaker {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.3rem;
            color: var(--primary);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 1rem;
            width: 28px;
            height: 28px;
        }

        .pixel-speaker:hover {
            color: var(--accent);
            filter: drop-shadow(0 0 6px rgba(253, 255, 182, 0.6));
            transform: scale(1.1);
        }

        .pixel-speaker:active {
            transform: scale(0.95);
        }

        .pixel-speaker.muted svg {
            opacity: 0.5;
        }

        #speaker-icon {
            stroke-linecap: round;
            stroke-linejoin: round;
            image-rendering: pixelated;
        }

        @keyframes glow { 0%, 100% { text-shadow: 2px 2px 0px #000, 0 0 5px var(--accent); } 50% { text-shadow: 2px 2px 0px #000, 0 0 15px var(--accent); } }

        @keyframes flicker { 0% { opacity: 0.15; } 50% { opacity: 0.1; } 100% { opacity: 0.15; } }
        @keyframes blink { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

        @media (max-width: 768px) {
            .hero h1 { font-size: 1.8rem; }
            nav { flex-direction: column; gap: 1rem; }
            .nav-links a { margin: 0 1rem; font-size: 0.6rem; }
            .pixel-avatar { height: 150px; }
            .hero p { font-size: 1rem; }
            .pixel-btn { padding: 0.8rem 1.5rem; font-size: 0.7rem; }
            .social-link { padding: 0.6rem 1rem; font-size: 0.6rem; }
            .section-title { font-size: 1.2rem; }
            .card { padding: 1rem; }
            .tag { font-size: 0.65rem; }
            #game-canvas { width: 100% !important; height: auto; }
            .game-controls { font-size: 0.7rem; }
            .stat-value { font-size: 1rem; }
            .arrow-btn { padding: 0.6rem 0.4rem; font-size: 1rem; }
            .touch-controls.show { display: grid; }
        }

        @media (max-width: 480px) {
            :root { --scanline-opacity: 0.08; }
            .hero h1 { font-size: 1.5rem; line-height: 1.2; }
            nav { padding: 1rem; }
            .logo { font-size: 0.9rem; }
            .nav-links a { margin: 0.5rem; font-size: 0.5rem; }
            .pixel-btn { padding: 0.6rem 1rem; font-size: 0.6rem; }
            .social-link { padding: 0.5rem 0.8rem; font-size: 0.55rem; gap: 0.5rem; }
            .about-section { padding: 1rem; }
            .section-title { font-size: 1rem; margin-bottom: 1.5rem; }
            .card { padding: 0.8rem; margin-bottom: 1rem; }
            .grid { gap: 1.5rem; grid-template-columns: 1fr; }
            .game-container { max-width: 100%; padding: 1rem; margin: 1rem auto; }
            .game-info { flex-direction: column; gap: 0.5rem; }
            .stat-label { font-size: 0.6rem; }
            .stat-value { font-size: 0.9rem; }
            #game-canvas { max-width: 100%; }
            .control-text { font-size: 0.65rem; }
            .arrow-btn { padding: 0.7rem 0.5rem; font-size: 0.9rem; }
            .touch-controls.show { display: grid; }
            footer { padding: 2rem 0; font-size: 0.8rem; }
        }
    </style>
</head>
<body>

    <div class="scanlines"></div>

    <!-- Background Music -->
    <audio id="bgm-player" loop preload="auto" muted>
        <source src="bgm.mp3" type="audio/mpeg">
    </audio>

    <nav>
        <div class="logo">SHUBHAM AMRITKAR</div>
        <div class="nav-links">
            <a href="#work">QUESTS</a>
            <a href="#game">GAME</a>
            <a href="#about">ABOUT</a>
            <a href="#contact">CONTACT</a>
            <button id="music-toggle" class="pixel-speaker">
                <svg id="speaker-icon" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                    <path d="M15 9c.7.7 1 1.6 1 2.5s-.3 1.8-1 2.5"></path>
                    <path d="M19 5c1.4 1.4 2 3.2 2 5s-.6 3.6-2 5"></path>
                </svg>
            </button>
            </div>
    </nav>

    <section class="hero">
        <div class="pixel-avatar">
            <img src="Gemini_Generated_Image_fgr8hlfgr8hlfgr8.png">
        </div>
        <h1>LEVEL UP YOUR<br>DIGITAL EXPERIENCE</h1>
        <p>Hi, I'm Shubham Amritkar. A Creative Developer crafting pixel-perfect worlds.</p>
        <a href="#about" class="pixel-btn">START GAME</a>
    </section>

    <section id="about" class="about-section">
        <h2 class="section-title">ABOUT ME</h2>
        <div style="max-width:800px; margin: 2rem auto; text-align:left;">
            <p><strong>Shubham Amritkar</strong> is a passionate and creative developer hailing from India. With a keen eye for design and a love for coding, I have been crafting digital experiences that captivate and engage users.</p>
            <p><strong>20yo</strong></p>
            <p><strong>Skills:</strong></p>
            <div class="tags" style="justify-content:flex-start;">
                <span class="tag">Graphics Designing</span>
                <span class="tag">Video Editing</span>
                <span class="tag">HTML</span>
                <span class="tag">CSS</span>
                <span class="tag">C programming</span>
            </div>

            <hr style="margin:1.5rem 0; border:none; border-top:2px solid rgba(255,255,255,0.06);">

            <p style="margin-top:1rem;"><strong>Languages (Proficiency):</strong></p>
            <div class="tags" style="justify-content:flex-start;">
                <span class="tag">English</span>
                <span class="tag">Hindi</span>
                <span class="tag">Marathi</span>
                <span class="tag">Japanese</span>
            </div>

            <p style="margin-top:1rem;"><strong>Software / Tools:</strong></p>
            <div class="tags" style="justify-content:flex-start;">
                <span class="tag">Adobe Photoshop</span>
                <span class="tag">Adobe Premiere Pro</span>
                <span class="tag">Adobe After Effects</span>
                <span class="tag">Blender</span>
            </div>
        </div>
    </section>

    <section id="work" class="projects">
        <div style="text-align: center;">
            <h2 class="section-title">QUEST LOG</h2>
        </div>
        
        <div class="grid" id="quest-grid">
            <p class="loading-text">LOADING SAVE FILE...</p>
        </div>
    </section>

    <section id="game" class="game-section">
        <h2 class="section-title">MINI GAME: PIXEL QUEST</h2>
        <div class="game-container">
            <div class="game-info">
                <div class="game-stat">
                    <span class="stat-label">SCORE:</span>
                    <span id="game-score" class="stat-value">0</span>
                </div>
                <div class="game-stat">
                    <span class="stat-label">HIGH:</span>
                    <span id="game-high-score" class="stat-value">0</span>
                </div>
                <div class="game-stat">
                    <span class="stat-label">STATUS:</span>
                    <span id="game-status" class="stat-value" style="color: var(--accent);">READY</span>
                </div>
            </div>
            
            <canvas id="game-canvas" width="400" height="400"></canvas>
            
            <div class="game-controls">
                <p class="control-text">USE ARROW KEYS OR WASD TO MOVE</p>
                <button class="pixel-btn" id="start-game-btn" style="margin-top: 1rem;">START GAME</button>
                <div class="touch-controls" id="touch-controls">
                    <button class="arrow-btn up" id="btn-up">▲</button>
                    <button class="arrow-btn left" id="btn-left">◄</button>
                    <button class="arrow-btn down" id="btn-down">▼</button>
                    <button class="arrow-btn right" id="btn-right">►</button>
                </div>
                <p style="font-size: 0.9rem; margin-top: 1rem; color: var(--secondary);">Collect all the golden pixels!<br>Don't hit the walls or yourself!</p>
            </div>
        </div>
    </section>

    <section id="contact" class="contact-section">
        <h2 class="section-title">CONNECT WITH ME</h2>
        <div class="social-links">
            <a href="https://github.com/amritkarShubham" target="_blank" class="social-link">GITHUB</a>
            <a href="https://www.instagram.com/amritkar_shubham10?igsh=MWUwbmYxd2Y5aHZucw==" target="_blank" class="social-link">INSTAGRAM</a>
            <a href="https://www.linkedin.com/in/shubham-amritkar-744b173a6/" target="_blank" class="social-link">LINKEDIN</a>
            <a href="https://discord.gg/sHSbPShV" target="_blank" class="social-link">DISCORD</a>
            <a href="mailto:amritkars78@gmail.com" class="social-link">EMAIL</a>
        </div>
    </section>

    <footer>
        <p>© 2026 SHUBHAM AMRITKAR. ALL RIGHTS RESERVED.</p>
        <p style="margin-top: 10px; font-size: 0.8rem;">PRESS ANY KEY TO CONTINUE...</p>
    </footer>

    <script>
        // THIS SECTION IS FOR THE OPTIONAL BACKEND
        // If you are just using the HTML file locally, this part won't load projects, 
        // but the rest of the site will look correct.
        async function loadQuests() {
            const grid = document.getElementById('quest-grid');
            try {
                // This tries to connect to a backend server (like the Node.js one previously discussed)
// We are manually putting the JSON here instead of fetching it
const quests = [
  {
    "id": 1,
    "title": "Farmer Advisory ChatBot",
    "description": "A React-based ChatBot that provides agricultural advice to farmers.",
    "tags": ["REACT", "CSS"],
    "image": "<img src='Gemini_Generated_Image_eo29epeo29epeo29.png' style='width: 100%; height: 100%; object-fit: cover;'>",
    "link": "https://github.com/amritkarShubham/AgriAssistant-f-"
  },
  {
    "id": 2,
    "title": "LPG Gas Leakage Detector",
    "description": "A hardware-based system to detect LPG gas leaks using sensors and alert users.",
    "tags": ["C++", "Arduino IDE"],
    "image": "<img src='Gemini_Generated_Image_eoln6yeoln6yeoln.png' style='width: 100%; height: 100%; object-fit: cover;'>",
    "link": "https://github.com/amritkarShubham/LPG-Gas-Leakage-Detector"
  }
];
                grid.innerHTML = '';
                quests.forEach(quest => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    const tagsHtml = quest.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
                    card.innerHTML = `
                        <div class="card-img">${quest.image}</div>
                        <h3>${quest.title}</h3>
                        <p>${quest.description}</p>
                        <div class="tags">${tagsHtml}</div>
                    `;
                    card.addEventListener('click', () => {
                        window.open(quest.link, '_blank');
                    });
                    grid.appendChild(card);
                });
            } catch (error) {
                console.error("Error:", error);
                // Default message if no backend is running
                grid.innerHTML = '<p style="text-align:center; color: #FFADAD;">NO BACKEND DETECTED.<br>(Projects load from server)</p>';
            }
        }

        const contactForm = document.getElementById('contact-form');
        if(contactForm) {
            contactForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                alert("Backend connection required to send messages.");
            });
        }

        window.onload = loadQuests;

        // ===== PIXEL QUEST GAME =====
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('start-game-btn');
        const touchControls = document.getElementById('touch-controls');
        
        // Responsive canvas
        function resizeCanvas() {
            const container = canvas.parentElement;
            const maxWidth = Math.min(400, container.clientWidth - 20);
            canvas.width = maxWidth;
            canvas.height = maxWidth;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        const gridSize = 20;
        let tileCount = canvas.width / gridSize;
        
        let snake = [{x: 10, y: 10}];
        let food = {x: Math.floor(Math.random() * tileCount), y: Math.floor(Math.random() * tileCount)};
        let dx = 1;
        let dy = 0;
        let score = 0;
        let highScore = localStorage.getItem('pixelQuestHighScore') || 0;
        let gameRunning = false;
        let gameOver = false;
        let nextDx = 1;
        let nextDy = 0;
        let gameSpeed = 150; // Start slow: 150ms
        let speedIncrement = 2; // Increase speed by 2ms per food collected
        let minSpeed = 50; // Minimum speed: 50ms (fastest)
        
        document.getElementById('game-high-score').textContent = highScore;
        
        // Show touch controls on mobile
        if (window.innerWidth <= 768) {
            touchControls.classList.add('show');
        }
        
        const colors = {
            snake: '#A0C4FF',
            snakeHead: '#FFADAD',
            food: '#FDFFB6',
            grid: '#3a3a3a'
        };
        
        function drawGame() {
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = colors.grid;
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= tileCount; i++) {
                ctx.beginPath();
                ctx.moveTo(i * gridSize, 0);
                ctx.lineTo(i * gridSize, canvas.height);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(0, i * gridSize);
                ctx.lineTo(canvas.width, i * gridSize);
                ctx.stroke();
            }
            
            // Draw food
            ctx.fillStyle = colors.food;
            ctx.shadowColor = colors.food;
            ctx.shadowBlur = 10;
            ctx.fillRect(food.x * gridSize + 2, food.y * gridSize + 2, gridSize - 4, gridSize - 4);
            ctx.shadowBlur = 0;
            
            // Draw snake body
            snake.forEach((segment, index) => {
                if (index === 0) {
                    ctx.fillStyle = colors.snakeHead;
                    ctx.shadowColor = colors.snakeHead;
                    ctx.shadowBlur = 15;
                } else {
                    ctx.fillStyle = colors.snake;
                    ctx.shadowBlur = 0;
                }
                ctx.fillRect(segment.x * gridSize + 1, segment.y * gridSize + 1, gridSize - 2, gridSize - 2);
            });
            ctx.shadowBlur = 0;
        }
        
        function updateGame() {
            if (!gameRunning || gameOver) return;
            
            dx = nextDx;
            dy = nextDy;
            
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // Check collisions with walls
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                endGame();
                return;
            }
            
            // Check collisions with self
            if (snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                endGame();
                return;
            }
            
            snake.unshift(head);
            
            // Check if food is eaten
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                document.getElementById('game-score').textContent = score;
                // Increase speed as score goes up
                if (gameSpeed > minSpeed) {
                    gameSpeed = Math.max(minSpeed, gameSpeed - speedIncrement);
                }
                // Spawn food at new random position
                let newFoodX = Math.floor(Math.random() * tileCount);
                let newFoodY = Math.floor(Math.random() * tileCount);
                // Make sure food doesn't spawn on snake
                while (snake.some(segment => segment.x === newFoodX && segment.y === newFoodY)) {
                    newFoodX = Math.floor(Math.random() * tileCount);
                    newFoodY = Math.floor(Math.random() * tileCount);
                }
                food = {x: newFoodX, y: newFoodY};
            } else {
                snake.pop();
            }
        }
        
        function gameLoop() {
            updateGame();
            drawGame();
            if (gameRunning) {
                setTimeout(gameLoop, gameSpeed);
            }
        }
        
        function startGame() {
            snake = [{x: 10, y: 10}];
            dx = 1;
            dy = 0;
            nextDx = 1;
            nextDy = 0;
            score = 0;
            gameSpeed = 150; // Reset to starting speed
            // Spawn food at random position
            let newFoodX = Math.floor(Math.random() * tileCount);
            let newFoodY = Math.floor(Math.random() * tileCount);
            food = {x: newFoodX, y: newFoodY};
            gameRunning = true;
            gameOver = false;
            document.getElementById('game-score').textContent = '0';
            document.getElementById('game-status').textContent = 'PLAYING';
            document.getElementById('game-status').style.color = 'var(--accent)';
            startBtn.textContent = 'RESET';
            drawGame();
            gameLoop();
        }
        
        function endGame() {
            gameRunning = false;
            gameOver = true;
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('pixelQuestHighScore', highScore);
                document.getElementById('game-high-score').textContent = highScore;
                document.getElementById('game-status').textContent = 'NEW HIGH!';
                document.getElementById('game-status').style.color = 'var(--primary)';
            } else {
                document.getElementById('game-status').textContent = 'GAME OVER';
                document.getElementById('game-status').style.color = 'var(--primary)';
            }
        }
        
        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            
            const key = e.key.toLowerCase();
            
            if ((key === 'arrowup' || key === 'w') && dy === 0) {
                nextDx = 0;
                nextDy = -1;
                e.preventDefault();
            }
            if ((key === 'arrowdown' || key === 's') && dy === 0) {
                nextDx = 0;
                nextDy = 1;
                e.preventDefault();
            }
            if ((key === 'arrowleft' || key === 'a') && dx === 0) {
                nextDx = -1;
                nextDy = 0;
                e.preventDefault();
            }
            if ((key === 'arrowright' || key === 'd') && dx === 0) {
                nextDx = 1;
                nextDy = 0;
                e.preventDefault();
            }
        });
        
        // Touch controls
        document.getElementById('btn-up').addEventListener('click', () => { if (gameRunning && dy === 0) { nextDx = 0; nextDy = -1; } });
        document.getElementById('btn-down').addEventListener('click', () => { if (gameRunning && dy === 0) { nextDx = 0; nextDy = 1; } });
        document.getElementById('btn-left').addEventListener('click', () => { if (gameRunning && dx === 0) { nextDx = -1; nextDy = 0; } });
        document.getElementById('btn-right').addEventListener('click', () => { if (gameRunning && dx === 0) { nextDx = 1; nextDy = 0; } });
        
        startBtn.addEventListener('click', startGame);
        
        // Initial draw
        drawGame();

        // ===== MUSIC PLAYER =====
        const bgmPlayer = document.getElementById('bgm-player');
        const musicToggle = document.getElementById('music-toggle');
        let isMusicPlaying = true;

        // Set volume to 30%
        bgmPlayer.volume = 0.3;

        // Start playing muted (browsers allow this)
        bgmPlayer.play().catch(err => {
            console.log('Muted autoplay started');
        });

        // Unmute on first user interaction
        function unmuteMusic() {
            if (bgmPlayer.muted) {
                bgmPlayer.muted = false;
                console.log('Music unmuted');
                document.removeEventListener('click', unmuteMusic);
                document.removeEventListener('keydown', unmuteMusic);
                document.removeEventListener('touchstart', unmuteMusic);
            }
        }

        document.addEventListener('click', unmuteMusic);
        document.addEventListener('keydown', unmuteMusic);
        document.addEventListener('touchstart', unmuteMusic);

        musicToggle.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            if (isMusicPlaying) {
                bgmPlayer.pause();
                bgmPlayer.muted = true;
                musicToggle.classList.add('muted');
                isMusicPlaying = false;
            } else {
                bgmPlayer.muted = false;
                bgmPlayer.play().catch(err => {
                    console.error('Audio playback failed:', err);
                });
                musicToggle.classList.remove('muted');
                isMusicPlaying = true;
            }
        });

        // Handle audio end to ensure loop works
        bgmPlayer.addEventListener('ended', () => {
            if (isMusicPlaying) {
                bgmPlayer.currentTime = 0;
                bgmPlayer.play();
            }
        });

        // Check if audio can load
        bgmPlayer.addEventListener('canplay', () => {
            console.log('Audio loaded successfully');
        });

        bgmPlayer.addEventListener('error', (e) => {
            console.error('Audio load error:', e);
        });
    </script>
</body>
</html>
